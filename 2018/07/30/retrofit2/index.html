<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="keyword"  content="">
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>
        
        retrofit2 - undefined
        
    </title>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/aircloud.css">
    <link rel="stylesheet" href="/css/gitment.css">
    <!--<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">-->
    <link href="//at.alicdn.com/t/font_620856_pl6z7sid89qkt9.css" rel="stylesheet" type="text/css">
    <!-- ga & ba script hoook -->
    <script></script>
</head>

<body>

<div class="site-nav-toggle" id="site-nav-toggle">
    <button>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
    </button>
</div>

<div class="index-about">
    <i>  </i>
</div>

<div class="index-container">
    
    <div class="index-left">
        
<div class="nav" id="nav">
    <div class="avatar-name">
        <div class="avatar">
            <img src="/" />
        </div>
        <div class="name">
            <i>zhoujw</i>
        </div>
    </div>
    <div class="contents" id="nav-content">
        <ul>
            <li >
                <a href="/">
                    <i class="iconfont icon-shouye1"></i>
                    <span>HOME</span>
                </a>
            </li>
            <li >
                <a href="/tags">
                    <i class="iconfont icon-biaoqian1"></i>
                    <span>TAGS</span>
                </a>
            </li>
            <li >
                <a href="/archives">
                    <i class="iconfont icon-guidang2"></i>
                    <span>ARCHIVES</span>
                </a>
            </li>
            <li >
                <a href="/about/">
                    <i class="iconfont icon-guanyu2"></i>
                    <span>ABOUT</span>
                </a>
            </li>
            
        </ul>
    </div>
    
        <div id="toc" class="toc-article">
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Retrofit2"><span class="toc-text">Retrofit2</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Introduce"><span class="toc-text">Introduce</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#API-Declaration"><span class="toc-text">API Declaration</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#REQUEST-METHOD"><span class="toc-text">REQUEST METHOD</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#URL-MANIPULATION"><span class="toc-text">URL MANIPULATION</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#FORM-ENCODE-AND-MULTIPART"><span class="toc-text">FORM ENCODE AND MULTIPART</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HEADER-MANIPULATION"><span class="toc-text">HEADER MANIPULATION</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SYNCHRONOUS-VS-ASYNCHRONOUS"><span class="toc-text">SYNCHRONOUS VS. ASYNCHRONOUS</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Retrofit-Configuration"><span class="toc-text">Retrofit Configuration</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#converters"><span class="toc-text">converters</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Custom-converters"><span class="toc-text">Custom converters</span></a></li></ol></li></ol></li></ol></li></ol>
</div>
    
</div>


<div class="search-field" id="search-field">
    <div class="search-container">
        <div class="search-input">
            <span id="esc-search"> <i class="icon-fanhui iconfont"></i></span>
            <input id="search-input"/>
            <span id="begin-search">search</span>
        </div>
        <div class="search-result-container" id="search-result-container">

        </div>
    </div>
</div>
        <div class="index-about-mobile">
            <i>  </i>
        </div>
    </div>
    
    <div class="index-middle">
        <!-- Main Content -->
        


<div class="post-container">
    <div class="post-title">
        retrofit2
    </div>

    <div class="post-meta">
        <span class="attr">Post：<span>2018-07-30 10:31:38</span></span>
        
        <span class="attr">Tags：/
        
        <a class="tag" href="/tags/#android retrofit network" title="android retrofit network">android retrofit network</a>
        <span>/</span>
        
        
        </span>
        <span class="attr">Visit：<span id="busuanzi_value_page_pv"></span>
</span>
</span>
    </div>
    <div class="post-content ">
        <h1 id="Retrofit2"><a href="#Retrofit2" class="headerlink" title="Retrofit2"></a>Retrofit2</h1><p>Retrofit is a type-safe HTTP client for Android and Java</p>
<h2 id="Introduce"><a href="#Introduce" class="headerlink" title="Introduce"></a>Introduce</h2><p>Retrofit turns your HTTP API into a Java interface<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public interface GitHubService&#123;</span><br><span class="line">	@GET(&quot;users/&#123;user&#125;/repos&quot;)</span><br><span class="line">	Call&lt;List&lt;Repo&gt;&gt; listRepos(@Path(&quot;user&quot;) String user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>The retrofit class generate an implementation of the GitHubService interface</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Retrofit retrofit = new Retrofit.Builder()</span><br><span class="line">	.baseUrl(&quot;https://api.github.com/&quot;)</span><br><span class="line">	.build()</span><br><span class="line"></span><br><span class="line">GitHubService service = retrofit.create(GitHubService.class);</span><br></pre></td></tr></table></figure>
<p>Each Call from the created GitHubService can make a synchronous or asynchronous HTTP<br>request to the remote webserver.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Call&lt;List&lt;Repo&gt;&gt; repos = service.listRepos(&quot;octocat&quot;);</span><br></pre></td></tr></table></figure>
<p>Use annotation to describe the HTTP request:</p>
<ul>
<li>URL parameter replacement and query parameter support</li>
<li>Object conversion to request body(e.g.,JSON, protocol buffers)</li>
<li>Multipart request body and file upload</li>
</ul>
<h2 id="API-Declaration"><a href="#API-Declaration" class="headerlink" title="API Declaration"></a>API Declaration</h2><p>Annotations on the interface methods and its parameters indicate how a request will be handled.</p>
<h4 id="REQUEST-METHOD"><a href="#REQUEST-METHOD" class="headerlink" title="REQUEST METHOD"></a>REQUEST METHOD</h4><p>Every method must have an HTTP annotation that provides the request method and relative URL/<br>There are five built-in annotations:<br>GET,POST,PUT,DELETE, and HEAD. The relative URL of the resource is specified in the annotation.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@GET(&quot;users/list&quot;)</span><br></pre></td></tr></table></figure></p>
<p>You can also specify query parameters in the URL.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@GET(&quot;users/list?sort=desc&quot;)</span><br></pre></td></tr></table></figure></p>
<h4 id="URL-MANIPULATION"><a href="#URL-MANIPULATION" class="headerlink" title="URL MANIPULATION"></a>URL MANIPULATION</h4><p>A request URL can be updated dynamically using replacement blocks and parameters on the method. A replacement block is an alphanumeric string surrounded by { and }. A corresponding parameter must be annotated with @Path using the same string.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">@GET(&quot;group/&#123;id&#125;users&quot;)</span><br><span class="line">Call&lt;list&lt;User&gt;&gt; grouplist(@Path(&quot;id&quot;) int groupId);</span><br></pre></td></tr></table></figure></p>
<p>Query parameters can also be added<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">@GET(&quot;group/&#123;id&#125;/users&quot;)</span><br><span class="line">Call&lt;List&lt;User&gt;&gt; groupList(@Path(&quot;id&quot;)) int groupId, @Query(&quot;sort&quot;) String sort);</span><br></pre></td></tr></table></figure></p>
<p>For complex query parameter combinations a Map can be used.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">@GET(&quot;users/new&quot;)</span><br><span class="line">Call&lt;User&gt; createUser(@Body User user);</span><br></pre></td></tr></table></figure></p>
<p>The object will also be converted using a converter specified on the Retrofit instance.<br>If no converter is added. only RequestBody can be used.</p>
<h4 id="FORM-ENCODE-AND-MULTIPART"><a href="#FORM-ENCODE-AND-MULTIPART" class="headerlink" title="FORM ENCODE AND MULTIPART"></a>FORM ENCODE AND MULTIPART</h4><p>Methods can also be declared to send form-encoded and multipart data.<br>Form-encoded data is sent when @FormUrlEncoded is present on the method. Each key-value pair is annotated with @Field containing the name and the object prociding the value.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@FormUrlEncoded</span><br><span class="line">@POST(&quot;user/edit&quot;)</span><br><span class="line">Call&lt;User&gt; updateUder(@Field(&quot;first_name&quot;) String first, @Field(&quot;last_name&quot;) String last);</span><br></pre></td></tr></table></figure>
<p>Multipart requests are used when @Multipart is present on the method. Parts are declared using the @Part annotation.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@Mulitpart</span><br><span class="line">@PUT(&quot;user/photo&quot;)</span><br><span class="line">Call&lt;User&gt; updateUser(@Part(&quot;photo&quot;) RequestBody photo, @part(&quot;description&quot;) RequestBody description);</span><br></pre></td></tr></table></figure></p>
<p>Multipart parts use one of Retrofit’s converters or they can implement RequestBody to handle their own serialization.</p>
<h4 id="HEADER-MANIPULATION"><a href="#HEADER-MANIPULATION" class="headerlink" title="HEADER MANIPULATION"></a>HEADER MANIPULATION</h4><p>You can set static headers for a method using the @Headers annotation.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@Headers(&quot;Cache-Control: max-age=64000&quot;)</span><br><span class="line">@GET(&quot;Widget/list&quot;)</span><br><span class="line">Call&lt;User&gt; getUser(@Path(&quot;username&quot;) String username);</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@Headers(&#123;</span><br><span class="line">	&quot;Accept : applocation/vnd.github.v3.full+json&quot;,</span><br><span class="line">	&quot;User-Agent : Retrofit-Sample-App&quot;</span><br><span class="line">	&#125;)</span><br><span class="line">@GET(&quot;users/&#123;username&#125;&quot;)</span><br><span class="line">Call&lt;User&gt; getUser(@Path(&quot;username&quot;) String username);</span><br></pre></td></tr></table></figure>
<p>Noted that headers do not overwrite each other. All headers with the same name will be included in the request.<br>A request Headers can be updated dynamically using the @Header annotation. A corresponding parameter must be provided to the @Header. If the value is null,<br>the header will be omitted. Otherwise, toString will be called on the value, and the result used.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">@GET(&quot;user&quot;)</span><br><span class="line">Call&lt;User&gt; getUser(@Header(&quot;Authorization&quot;) String authorization)</span><br></pre></td></tr></table></figure></p>
<p>Similar to query parameters, for complex header combinations, a Map can be used.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">@GET(&quot;user&quot;)</span><br><span class="line">Call&lt;User&gt; getUser(@HeaderMap Map&lt;String,String&gt; headers)</span><br></pre></td></tr></table></figure></p>
<p>Headers that need to be added to every request can be specified using an OkHttp interceptor.</p>
<h4 id="SYNCHRONOUS-VS-ASYNCHRONOUS"><a href="#SYNCHRONOUS-VS-ASYNCHRONOUS" class="headerlink" title="SYNCHRONOUS VS. ASYNCHRONOUS"></a>SYNCHRONOUS VS. ASYNCHRONOUS</h4><p>Call instances can be executed either synchronously or asynchronously. Each instandce can be only be used once, but calling clone() will create a new instance that can be used.<br>On Android, callbacks will be executed on the main thread. On the JVM, callbacks will happen on the same thread that executed the HTTP request.</p>
<h2 id="Retrofit-Configuration"><a href="#Retrofit-Configuration" class="headerlink" title="Retrofit Configuration"></a>Retrofit Configuration</h2><p>Retrofits is the class through which your API interfaces are turned into callable objects. By default, Retrofit will give you sane defaults for your plantform but it allows for customization.</p>
<h4 id="converters"><a href="#converters" class="headerlink" title="converters"></a>converters</h4><p>By default, Retrofit can only deserialize HTTP bodies into OkHttp’s ResponseBody<br>type and it can only accept its RequestBody type for @Body.</p>
<p>Converters can be added to support other types. Six sibling modules adapt popular serialization libraries for your convenience.</p>
<ul>
<li>Gson</li>
<li>Jackson</li>
<li>Moshi</li>
<li>Protobuf</li>
<li>Wire</li>
<li>Simple XML</li>
<li>Scalars</li>
</ul>
<p>Here’s an example of using the GsonConverterFactory class to generate an inplementation of the GitHubService interface which uses Gson for its deserialization.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Retrofit retrofit = new Retrofit.Builder()</span><br><span class="line">	.baseUrl(&quot;http://api.github.com&quot;)</span><br><span class="line">	.addCoverterFactory(GsonConverterFactory.create())</span><br><span class="line">	.build();</span><br><span class="line">GitHubService service = retrofit.create(GitHubService.class)</span><br></pre></td></tr></table></figure></p>
<h4 id="Custom-converters"><a href="#Custom-converters" class="headerlink" title="Custom converters"></a>Custom converters</h4><p>If you need to communicate with an API that uses a content-format that Retrofit does not support out of the box(e.g. YAML, txt. custom format) or you wish to use a different library to implement an existing format, you can easily create your own converter. Create a class that extends the Converter.Factory class and pass in an instance when building your adapter.</p>

        
        <div id="comment-container">
        </div>
    </div>
</div>
    </div>
</div>


<footer class="footer">
    <ul class="list-inline text-center">
        
        

        

        

        

        

    </ul>
    
    <p>
        <span id="busuanzi_container_site_pv">
            <span id="busuanzi_value_site_pv"></span>PV
        </span>
        <span id="busuanzi_container_site_uv">
            <span id="busuanzi_value_site_uv"></span>UV
        </span>
        Created By <a href="https://hexo.io/">Hexo</a>  Theme <a href="https://github.com/aircloud/hexo-theme-aircloud">AirCloud</a></p>
</footer>




</body>

<script>
    // We expose some of the variables needed by the front end
    window.hexo_search_path = ""
    window.hexo_root = "/"
    window.isPost = true
</script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script src="/js/index.js"></script>
<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

</html>
